# 진행 준비 내용 (정리)

## 목표
- 연말정산 계산 사이트에 아래 기능을 추가한다:
  - 익명 게시판(댓글 포함)
  - 오픈그래프(OG) 공유 기능(24시간 만료)

## 오픈그래프(OG) 공유 기능
- 사용자 입력으로 계산된 결과 금액을 OG 카드 문구에 표시한다.
  - 문구 예: "예상 환급액 59만원" 또는 "추가 납부액 12만원"
- 공유 페이지는 **사용자 입력 데이터는 노출하지 않고**, 사이트 메인 페이지가 보이게 한다.
- 공유 링크는 **24시간 후 만료**된다.
  - 만료 후 OG는 만료 안내 카드로 처리한다.
- 정적 HTML만으로는 불가하므로 **서버리스(Cloudflare Workers 등)**가 필요하다.
- 구현 개념:
  - `/api/share` 결과 저장(shareId 발급)
  - `/share/:id` OG 메타 제공 (본문은 메인)
  - OG 이미지는 기본 히어로 이미지를 사용
  - `Cache-Control: no-store` 적용

## 익명 게시판
- **통합 게시판** (카테고리 없음)
- **완전 익명**
- **게시글/댓글 모두 비밀번호로 수정/삭제 가능**
- **댓글/답글 기능 필요**
- **스팸 방지 최소 기능**(예: 작성 쿨다운)
- 게시판은 **별도 페이지**(`/board`)로 제공

## 필터링(필수)
- 등록 단계에서 **금칙어 필터(Blacklist)**로 차단
- 대상: 욕설, 성인 관련 단어, 도박 용어 등
- 필터 방식: **완화(단어 단위 기반)**
- 단, **한글 변형/띄어쓰기/반복 글자(예: ㅅㅂ, ㅆㅂ 등)는 최대한 차단**
- 초기 금칙어 목록은 **기본 리스트로 시작**

## 플랫폼/배포 방향
- GitHub 업로드 후 Cloudflare Pages 연동
- D1/KV 사용 (게시판 + 공유 TTL + 광고 캐시)

## 쿠팡파트너스 연동 (배너 광고)
- 쿠팡파트너스 Open API로 추천 상품 배너 표시
- 사용자 관심 로그(카테고리 집계)를 기반으로 상품 검색
- API 키는 **클라이언트에 노출 금지**, Cloudflare Secrets로만 저장
- 주요 환경 변수:
  - `COUPANG_ACCESS_KEY`
  - `COUPANG_SECRET_KEY`
  - `COUPANG_SUB_ID` (선택)
- `쿠팡파트너스api정보.txt`는 **레포에 포함하지 않음**(.gitignore 처리)

## 게시판 비밀번호/스팸 보호
- 선택 환경 변수:
  - `PASSWORD_PEPPER` (비밀번호 해시용)
  - `IP_PEPPER` (IP 해시용)

## Cloudflare 리소스
- D1 바인딩명: `DB` (게시글/댓글/관심 로그 저장)
- KV 바인딩명: `APP_KV` (공유 링크 TTL, 스팸 방지 쿨다운, 배너 캐시)
- 스키마: `schema.sql` 적용

## 미정/확인 필요
- Cloudflare D1/KV 사용 가능 여부 (추후 결정)
- 실제 배포 도메인 (추후 확정)
